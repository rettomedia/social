{% extends 'base.jinja' %}
{% load static %}
{% block title %}Feed{% endblock %}

{% block content %}

<div class="preloader"></div>


<div class="main-wrapper">

    {% include '../components/_nav.jinja' with page=request.path %}
    {% include '../components/_left.jinja' %}

    <!-- main content -->
    <div class="main-content right-chat-active">

        <div class="middle-sidebar-bottom">
            <div class="middle-sidebar-left">
                <!-- loader wrapper -->
                <div class="preloader-wrap p-3">
                    <div class="box shimmer">
                        <div class="lines">
                            <div class="line s_shimmer"></div>
                            <div class="line s_shimmer"></div>
                            <div class="line s_shimmer"></div>
                            <div class="line s_shimmer"></div>
                        </div>
                    </div>
                    <div class="box shimmer mb-3">
                        <div class="lines">
                            <div class="line s_shimmer"></div>
                            <div class="line s_shimmer"></div>
                            <div class="line s_shimmer"></div>
                            <div class="line s_shimmer"></div>
                        </div>
                    </div>
                    <div class="box shimmer">
                        <div class="lines">
                            <div class="line s_shimmer"></div>
                            <div class="line s_shimmer"></div>
                            <div class="line s_shimmer"></div>
                            <div class="line s_shimmer"></div>
                        </div>
                    </div>
                </div>
                <!-- loader wrapper -->
                <div class="row feed-body">
                    <div class="col-xl-10 col-xxl-10 col-lg-10">
                        <div class="card w-100 shadow-xss rounded-xxl border-0 ps-4 pt-4 pe-4 pb-3 mb-3">
                            <div class="card-body p-0">
                                <a class=" font-xssss fw-600 text-grey-500 card-body p-0 d-flex align-items-center"><i
                                        class="btn-round-sm font-xs text-primary feather-edit-3 me-2 bg-greylight"></i>Create
                                    Post</a>
                            </div>
                            <div class="card-body p-0 mt-3 position-relative">
                                <figure class="avatar position-absolute ms-2 mt-1 top-5">
                                    {% if request.user.avatar %}
                                    <img src="{{request.user.avatar.url}}" alt="image"
                                        class="shadow-sm rounded-circle w30">
                                    {% else %}
                                    <img src="{% static 'images/blank-profile.jpg' %}" alt="image"
                                        class="shadow-sm rounded-circle w30">
                                    {% endif %}
                                </figure>
                                <form enctype="multipart/form-data" action="{% url 'add_post' %}" method="post">
                                    {% csrf_token %}
                                    <textarea name="message" id="message"
                                        class="h100 bor-0 w-100 rounded-xxl p-2 ps-5 font-xssss text-grey-500 fw-500 border-light-md theme-dark-bg"
                                        cols="30" rows="10" placeholder="What's on your mind?"></textarea>
                                    <span style="margin-top: 10px"
                                        class="w-50 h-25 d-flex align-items-center font-xssss fw-600 ls-1 text-grey-700 text-dark pe-4"><i
                                            class="font-md text-success feather-image me-2"></i>
                                        <input id="image" name="image" type="file">
                                    </span>
                                    <button style="border: none !important;margin-top:10px" type="submit"
                                        class="p-2 lh-20 w100 bg-primary-gradiant me-2 text-white text-center font-xssss fw-600 ls-1 rounded-xl">Share</a>
                                </form>
                            </div>
                            <div class="card-body d-flex p-0 mt-0">
                            </div>
                        </div>


                        {% for post in posts %}
                        <div class="card w-100 shadow-xss rounded-xxl border-0 p-4 mb-3">
                            <div class="card-body p-0 d-flex">
                                <figure class="avatar me-3">
                                    {% if post.author.avatar %}
                                    <img src="{{post.author.avatar.url}}" alt="image"
                                        class="shadow-sm rounded-circle w45">
                                    {% else %}
                                    <img src="{% static 'images/blank-profile.jpg'  %}" alt="image"
                                        class="shadow-sm rounded-circle w45">
                                    {% endif %}
                                </figure>
                                <h4 class="fw-700 text-grey-900 font-xssss mt-1"><a class="text-dark"
                                        href="/@{{post.author.username}}/">{{post.author.username}}</a> <span class="badge badge-danger"><i class="bi bi-check"></i></span><span
                                        class="d-block font-xssss fw-500 mt-1 lh-3 text-grey-500">{{post.edited_at}}</span>
                                </h4>
                            </div>
                            <div class="card-body p-0 me-lg-5">
                                <p class="fw-500 text-grey-500 lh-26 font-xssss w-100">
                                    <a class="text-dark" href="/posts/{{post.author.username}}/{{post.slug}}/">
                                        {{post.media}}
                                        {{post.message|safe}}
                                    </a>
                                </p>
                            </div>
                            <div class="card-body d-block p-0">
                                <div class="row ps-2 pe-2">
                                    <div class="col-xs-4 col-sm-4 p-1"><a
                                            href="/posts/{{post.author.username}}/{{post.slug}}/">
                                            {% if post.image %}
                                            <img src="{{post.image.url}}" class="rounded-3 w-75" alt="image">
                                            {% endif %}
                                        </a></div>
                                </div>
                            </div>
                            <div class="card-body d-flex p-0 mt-3">
                                <button data-post-slug="{{post.slug}}"
                                    style="background: none !important;border: none !important"
                                    class="d-flex like-button-main align-items-center fw-600 text-grey-900 text-dark lh-26 font-xssss me-2"><i
                                        class="feather-thumbs-up text-white bg-primary-gradiant me-1 btn-round-xs font-xss"></i><span
                                        id="likes-count-{{post.slug}}">{{post.likes.count}} </span></button>
                                <a class="d-flex align-items-center fw-600 text-grey-900 text-dark lh-26 font-xssss"><i
                                        class="feather-message-circle text-dark text-grey-900 btn-round-sm font-lg"></i><span
                                        class="d-none-xss">{{post.comments.count}} </span></a>
                                <a href="#" id="dropdownMenu21" data-bs-toggle="dropdown" aria-expanded="false"
                                    class="ms-auto d-flex align-items-center fw-600 text-grey-900 text-dark lh-26 font-xssss"><i
                                        class="feather-share-2 text-grey-900 text-dark btn-round-sm font-lg"></i><span
                                        class="d-none-xs">Share</span></a>
                                <div class="dropdown-menu dropdown-menu-end p-4 rounded-xxl border-0 shadow-lg"
                                    aria-labelledby="dropdownMenu21">
                                    <h4 class="fw-700 font-xss text-grey-900 d-flex align-items-center">Share <i
                                            class="feather-x ms-auto font-xssss btn-round-xs bg-greylight text-grey-900 me-2"></i>
                                    </h4>
                                    <div class="card-body p-0 d-flex">
                                        <ul class="d-flex align-items-center justify-content-between mt-2">
                                            <li class="me-1"><a href="#" class="btn-round-lg bg-facebook"><i
                                                        class="font-xs ti-facebook text-white"></i></a></li>
                                            <li class="me-1"><a href="#" class="btn-round-lg bg-twiiter"><i
                                                        class="font-xs ti-twitter-alt text-white"></i></a></li>
                                            <li class="me-1"><a href="#" class="btn-round-lg bg-linkedin"><i
                                                        class="font-xs ti-linkedin text-white"></i></a></li>
                                            <li class="me-1"><a href="#" class="btn-round-lg bg-instagram"><i
                                                        class="font-xs ti-instagram text-white"></i></a></li>
                                            <li><a href="#" class="btn-round-lg bg-pinterest"><i
                                                        class="font-xs ti-pinterest text-white"></i></a></li>
                                        </ul>
                                    </div>
                                    <div class="card-body p-0 d-flex">
                                        <ul class="d-flex align-items-center justify-content-between mt-2">
                                            <li class="me-1"><a href="#" class="btn-round-lg bg-tumblr"><i
                                                        class="font-xs ti-tumblr text-white"></i></a></li>
                                            <li class="me-1"><a href="#" class="btn-round-lg bg-youtube"><i
                                                        class="font-xs ti-youtube text-white"></i></a></li>
                                            <li class="me-1"><a href="#" class="btn-round-lg bg-flicker"><i
                                                        class="font-xs ti-flickr text-white"></i></a></li>
                                            <li class="me-1"><a href="#" class="btn-round-lg bg-black"><i
                                                        class="font-xs ti-vimeo-alt text-white"></i></a></li>
                                            <li><a href="#" class="btn-round-lg bg-whatsup"><i
                                                        class="font-xs feather-phone text-white"></i></a></li>
                                        </ul>
                                    </div>
                                    <h4 class="fw-700 font-xssss mt-4 text-grey-500 d-flex align-items-center mb-3">
                                        Share
                                        Link</h4>
                                    <input type="text"
                                        value="https://retto.social/posts/{{post.author.username}}/{{post.slug}}"
                                        class="bg-grey text-grey-500 font-xssss border-0 lh-32 p-2 font-xssss fw-600 rounded-3 w-100 theme-dark-bg">
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

            </div>
        </div>
        <!-- main content -->

        {% include '../components/_right-chat.jinja' %}
        {% include '../components/_footer.jinja' %}
        {% include '../components/_search-header.jinja' %}

    </div>

    {% include '../components/_chat-popup.jinja' %}
    {% endblock %}